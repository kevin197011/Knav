---
alwaysApply: true
---
# ğŸš€ DevOps å¼€å‘è§„èŒƒ

> ä¸“æ³¨äº DevOps å¹³å°/å·¥å…·å¼€å‘é¡¹ç›®çš„æœ€ä½³å®è·µè§„èŒƒ

---

## ğŸ”§ é€šç”¨è§„åˆ™ï¼ˆUniversal Rulesï¼‰

| ç¼–å· | å†…å®¹ |
|------|------|
| R1  | æ‰€æœ‰ä»£ç å¿…é¡»é€šè¿‡ Linterï¼ˆå¦‚ ESLintã€golangci-lintã€Rubocopï¼‰å’Œæ ¼å¼åŒ–å·¥å…·ï¼ˆPrettierã€Blackã€go fmt ç­‰ï¼‰ |
| R2  | æ‰€æœ‰æäº¤å¿…é¡»åŒ…å«æ¸…æ™°æè¿°ï¼Œæ”¯æŒä½¿ç”¨ [Conventional Commits](mdc:https:/www.conventionalcommits.org) æ ¼å¼ |
| R3  | é¡¹ç›®åº”æ”¯æŒ `dev` ä¸€é”®å¯åŠ¨ï¼ˆå¦‚ `make dev` / `docker-compose up`ï¼‰ |
| R4  | æ‰€æœ‰å˜æ›´å¿…é¡»é€šè¿‡ä»£ç å®¡æŸ¥ï¼ˆè‡³å°‘ 1 äººå®¡æ‰¹ï¼‰ |
| R5  | æ‰€æœ‰æœåŠ¡å’Œè„šæœ¬å¿…é¡»å…·å¤‡ `--help` æ”¯æŒå’Œ README è¯´æ˜ |
| R6  | æ‰€æœ‰æ—¥å¿—å¿…é¡»ç»“æ„åŒ–è¾“å‡ºï¼ˆJSON / Logfmt / K-Vï¼‰ï¼Œå¹¶åŠ ä¸Š trace ID æˆ– request ID |
| R7  | Cursor ç¼–è¾‘å™¨ä¸­éœ€å¯ç”¨ GPT è‡ªåŠ¨æ³¨é‡Š + å•å…ƒæµ‹è¯•å»ºè®®ï¼Œæå‡æ™ºèƒ½ååŒæ•ˆç‡ |

---

## â˜¸ï¸ DevOps & Infra è§„åˆ™ï¼ˆDevOps Rulesï¼‰

| ç¼–å· | å†…å®¹ |
|------|------|
| D1  | æ‰€æœ‰æœåŠ¡å¿…é¡»å…·å¤‡ Dockerfile å’Œ Kubernetes YAML/Helm æ”¯æŒ |
| D2  | æ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²ï¼ˆdev/staging/prodï¼‰ï¼Œé…ç½®éš”ç¦» |
| D3  | CI/CD ä½¿ç”¨ GitHub Actions / GitLab CI / ArgoCD / Tektonï¼Œæœ€å°‘åŒ…å«å•æµ‹ã€æ„å»ºã€éƒ¨ç½² |
| D4  | æ‰€æœ‰ä»»åŠ¡åº”è®°å½•æ‰§è¡Œæ—¥å¿—ã€çŠ¶æ€ï¼Œå¹¶ä¿ç•™å†å²è®°å½• |
| D5  | æ‰€æœ‰æ„å»ºäº§ç‰©åº”æ‰“ä¸Šå”¯ä¸€ç‰ˆæœ¬å·ï¼ˆGit commit SHA + tagï¼‰ |
| D6  | åº”ç”¨å¿…é¡»æ”¯æŒé›¶åœæœºéƒ¨ç½²ï¼ˆreadiness probe, blue-green, rollingï¼‰ |
| D7  | æ‰€æœ‰å¤–éƒ¨æœåŠ¡ä¾èµ–å¿…é¡»æ˜¾å¼å®šä¹‰ï¼ˆå¦‚ Redisã€DBã€MQï¼‰å¹¶æ”¯æŒæ¨¡æ‹Ÿæ¨¡å¼ |
| D8  | ä½¿ç”¨ `Terraform` / `Pulumi` ç®¡ç†åŸºç¡€è®¾æ–½ï¼Œé…ç½®åº”æ¨¡å—åŒ– |
| D9  | æ‰€æœ‰æœåŠ¡åº”æ¥å…¥ç»Ÿä¸€ç›‘æ§ï¼ˆå¦‚ Prometheus + Grafanaï¼‰å’Œå‘Šè­¦ç³»ç»Ÿï¼ˆAlertmanagerã€PagerDutyï¼‰ |

---

## ğŸ”§ Infrastructure as Code (IaC)

- ä½¿ç”¨ Terraformã€Ansibleã€CloudFormationã€Pulumi ç­‰å·¥å…·
- æ‰€æœ‰åŸºç¡€è®¾æ–½é…ç½®å¿…é¡»ç‰ˆæœ¬åŒ–
- ç¯å¢ƒé…ç½®åº”è¯¥æ˜¯å¹‚ç­‰çš„å’Œå¯é‡å¤çš„
- ä½¿ç”¨æ¨¡å—åŒ–å’Œå¯é‡ç”¨çš„é…ç½®

```hcl
# Terraform ç¤ºä¾‹ç»“æ„
resource "aws_instance" "example" {
  ami           = var.ami_id
  instance_type = var.instance_type

  tags = {
    Name        = "${var.project_name}-${var.environment}"
    Environment = var.environment
    Project     = var.project_name
  }
}
```

### å®¹å™¨åŒ–å’Œç¼–æ’
- ä½¿ç”¨ Docker è¿›è¡Œå®¹å™¨åŒ–
- å®æ–½å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒå¤§å°
- ä½¿ç”¨ Kubernetes æˆ– Docker Compose è¿›è¡Œç¼–æ’
- å®æ–½å¥åº·æ£€æŸ¥å’Œèµ„æºé™åˆ¶

```dockerfile
# å¤šé˜¶æ®µæ„å»ºç¤ºä¾‹
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM node:18-alpine AS runtime
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY . .
EXPOSE 3000
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/health || exit 1
CMD ["npm", "start"]
```

### CI/CD æµæ°´çº¿
- å®æ–½è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ„å»ºå’Œéƒ¨ç½²
- ä½¿ç”¨è“ç»¿éƒ¨ç½²æˆ–æ»šåŠ¨æ›´æ–°
- å®æ–½è‡ªåŠ¨å›æ»šæœºåˆ¶
- é›†æˆå®‰å…¨æ‰«æå’Œä»£ç è´¨é‡æ£€æŸ¥

```yaml
# GitHub Actions ç¤ºä¾‹
name: CI/CD Pipeline
on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run Tests
        run: |
          make test
          make security-scan
          make lint

  deploy:
    needs: test
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Production
        run: make deploy-prod
```

### ç›‘æ§å’Œæ—¥å¿—
- å®æ–½åº”ç”¨æ€§èƒ½ç›‘æ§(APM)
- ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—
- è®¾ç½®å‘Šè­¦å’Œä»ªè¡¨æ¿
- å®æ–½åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª

```json
{
  "timestamp": "2024-12-31T10:00:00Z",
  "level": "info",
  "service": "user-service",
  "trace_id": "abc123",
  "span_id": "def456",
  "message": "User created successfully",
  "user_id": "12345",
  "duration_ms": 150
}
```

---

## ğŸ” å®‰å…¨è§„åˆ™ï¼ˆSecurity Rulesï¼‰

| ç¼–å· | å†…å®¹ |
|------|------|
| S1  | ä¸å¾—å°†å¯†ç ã€Tokenã€å¯†é’¥ç­‰å†™å…¥ Gitï¼ˆä½¿ç”¨ Secret Managerã€Vaultã€dotenv-vaultï¼‰ |
| S2  | æ‰€æœ‰å¤–éƒ¨ API è¯·æ±‚åº”å¯ç”¨ TLS/HTTPS |
| S3  | æ‰€æœ‰ Web è¡¨å•å¿…é¡»é˜²æ­¢ CSRF/XSS/SQL æ³¨å…¥ |
| S4  | æ‰€æœ‰ç«¯å£å¼€æ”¾å¿…é¡»å—é™äºé˜²ç«å¢™ / å®‰å…¨ç»„ |
| S5  | æ‰€æœ‰ä¾èµ–é¡¹å¿…é¡»å®šæœŸæ‰«ææ¼æ´ï¼ˆDependabot / snyk / osv-scannerï¼‰ |
| S6  | æ‰€æœ‰è®¤è¯å¿…é¡»åŠ ç›åŠ å¯†å­˜å‚¨ï¼ˆå¦‚ bcrypt, Argon2ï¼‰ |

---

## âœ… æµ‹è¯•è§„åˆ™ï¼ˆTesting Rulesï¼‰

| ç¼–å· | å†…å®¹ |
|------|------|
| T1  | å•å…ƒæµ‹è¯•å¿…é¡»è¦†ç›–æ ¸å¿ƒé€»è¾‘ï¼Œä»£ç è¦†ç›–ç‡ â‰¥ 80% |
| T2  | æ‰€æœ‰ PR æäº¤å‰å¿…é¡»é€šè¿‡ CI æµ‹è¯• |
| T3  | æµ‹è¯•åº”åŒ…å«ï¼šå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€e2e æµ‹è¯•ï¼ˆå¯ç”¨ Playwright/Cypressï¼‰ |
| T4  | æµ‹è¯•æ•°æ®åº”ä½¿ç”¨ Mockã€Fixture æˆ–æµ‹è¯•æ•°æ®åº“éš”ç¦» |
| T5  | è‹¥ä½¿ç”¨ gRPC/äº‹ä»¶é˜Ÿåˆ—ï¼Œåº”æ·»åŠ æ¨¡æ‹Ÿå™¨æˆ–æµ‹è¯•å®¹å™¨ |

---

## ğŸ“ æ–‡æ¡£è§„èŒƒï¼ˆDocs Rulesï¼‰

| ç¼–å· | å†…å®¹ |
|------|------|
| W1  | æ¯ä¸ªæœåŠ¡å¿…é¡»æä¾›è‹±æ–‡ README.md å’Œä¸­æ–‡ README.zh-CN.mdï¼ŒåŒ…å«å®‰è£…ã€è¿è¡Œã€æµ‹è¯•ã€éƒ¨ç½²è¯´æ˜ |
| W2  | æ‰€æœ‰ä»£ç è¾“å‡ºä¿¡æ¯ï¼ˆæ—¥å¿—ã€é”™è¯¯ä¿¡æ¯ã€ç”¨æˆ·æç¤ºç­‰ï¼‰å¿…é¡»ä½¿ç”¨è‹±æ–‡ |
| W3  | æ‰€æœ‰æ¥å£éœ€è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼ˆå¦‚ Swagger, Redocï¼‰ |
| W4  | æ‰€æœ‰æ¶æ„å›¾å¿…é¡»åŒæ­¥ï¼ˆå»ºè®®ç”¨ Excalidraw / Mermaidï¼‰ |
| W5  | é¡¹ç›®æ ¹ç›®å½•éœ€æœ‰ `docs/` æ–‡ä»¶å¤¹ï¼Œæ”¯æŒ MkDocs æˆ– Docify æ„å»º |
| W6  | æŠ€æœ¯æœ¯è¯­åœ¨ä¸­æ–‡æ–‡æ¡£ä¸­ä¿æŒè‹±æ–‡åŸæ–‡ |
| W7  | ä¸¤ç§è¯­è¨€çš„æ–‡æ¡£å¿…é¡»ä¿æŒç»“æ„ä¸€è‡´ï¼ŒåŒæ­¥æ›´æ–° |

---

## ğŸ“¦ é¡¹ç›®ç»“æ„ï¼ˆå»ºè®®æ¨¡æ¿ï¼‰

```text
.
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.go / app.py / app.rb
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ config/
â”‚   â””â”€â”€ api/
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ public/
â”‚   â””â”€â”€ tailwind.config.js
â”œâ”€â”€ infra/
â”‚   â”œâ”€â”€ terraform/
â”‚   â””â”€â”€ k8s/
â”œâ”€â”€ .github/workflows/
â”œâ”€â”€ Makefile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env
â””â”€â”€ README.md
```